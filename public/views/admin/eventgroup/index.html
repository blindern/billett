<div class="page-header">
    <h1>{{group.title}}</h1>
</div>

<p><a href="a">&laquo; Tilbake</a></p>

<h2>
    Arrangementliste
    <a href="a/eventgroup/{{group.id}}/new_event" class="pull-right btn btn-default">Nytt arrangement</a>
</h2>


<div ng-show="group.events.length == 0">
    <p>Ingen arrangementer eksisterer.</p>
</div>

<div ng-show="group.events.length > 0">
    <div class="form-inline">
        <select class="form-control" ng-model="filter_sale" ng-change="applyFilter()">
            <option value="">Vis alle salgsmodus</option>
            <option value="1">Kun med billettgrupper</option>
            <option value="0">Kun uten billettgrupper</option>
        </select>
        <select class="form-control" ng-model="filter_category" ng-change="applyFilter()" ng-options="event.category as event.category for event in group.events|unique:'category'">
            <option value="">Vis alle kategorier</option>
        </select>
    </div>

    <table class="table table-striped table-tbody-spacing">
        <thead>
            <tr>
                <th>Aften</th>
                <th>Tittel</th>
                <th>Varighet</th>
                <th>Solgte</th>
                <th>Tilgjengelige</th>
                <th>Omsatt</th>
                <th>Pub?</th>
                <th>Salg?</th>
            </tr>
        </thead>
        <tbody ng-repeat="(day, events) in days">
            <tr ng-repeat="event in events">
                <td>{{event.time_start|formatdate:'dddd'}}</td><!-- fixme: 6 am should count at the day before -->
                <td>
                    <span ng-show="event.category">{{event.category}}: </span>
                    <a ng-href="a/event/{{event.id}}">{{event.title}}</a>
                </td>
                <td>
                    {{event.time_start|formatdate:'YYYY-MM-DD HH:mm'}}
                    <span ng-show="event.time_end && event.time_end != event.time_start">
                        -
                        {{event.time_end|formatdate:'HH:mm'}}
                    </span>
                </td>
                <td>{{event.ticket_count.totals.valid}}</td>
                <td>{{event.ticket_count.totals.free}}</td>
                <td>{{event.ticket_count.totals.sum_price+event.ticket_count.totals.sum_fee|price}}</td>
                <td class="eventgroup-event-action" ng-click="eventTogglePublish(event)"><i class="glyphicon" ng-class="event.is_published ? 'glyphicon-ok' : 'glyphicon-remove'"></i></td>
                <td class="eventgroup-event-action" ng-click="eventToggleSelling(event)"><i class="glyphicon glyphicon-usd" ng-class="{'event-not-selling': !event.is_selling}"></i></td>
            </tr>
        </tbody>
    </table>

</div>